/*%FSM<COMPILE "C:\BIS\FSMEditor\scriptedFSM.cfg, A_m04 Mission Flow">*/
/*%FSM<HEAD>*/
/*
item0[] = {"init",0,250,60.000000,-2110.000000,150.000000,-2060.000000,0.000000,"init"};
item1[] = {"mission_started",4,218,60.000000,-2020.000000,150.000000,-1970.000000,0.000000,"mission" \n "started"};
item2[] = {"regroup_started",2,250,60.000000,-1930.000000,150.000000,-1880.000000,0.000000,"regroup" \n "started"};
item3[] = {"near_group",4,218,60.000000,-1840.000000,150.000000,-1790.000000,0.000000,"near" \n "group"};
item4[] = {"backpack_started",2,250,60.000000,-1750.000000,150.000000,-1700.000000,0.000000,"backpack" \n "started"};
item5[] = {"near_contact_pos",4,218,60.000000,-1300.000000,150.000000,-1250.000000,0.000000,"near" \n "contact position"};
item6[] = {"lz_connor_starte",2,250,60.000000,420.000000,150.000000,470.000000,0.000000,"lz connor" \n "started"};
item7[] = {"lz_connor_secure",4,218,60.000000,510.000000,150.000000,560.000000,0.000000,"lz connor" \n "secure"};
item8[] = {"lz_connor_is_att",2,250,60.000000,-1030.000000,150.000000,-980.000000,0.000000,"lz connor" \n "is attacked"};
item9[] = {"on_the_way_to_ni",4,218,60.000000,-1480.000000,150.000000,-1430.000000,1.000000,"on the way" \n "to nikos"};
item10[] = {"dialog_about_the",2,250,60.000000,-1390.000000,150.000000,-1340.000000,0.000000,"dialog about" \n "the contact"};
item11[] = {"delay",4,218,60.000000,-940.000000,150.000000,-890.000000,0.000000,"delay"};
item12[] = {"react_to_explosions",2,250,60.000000,-850.000000,150.000000,-800.000000,0.000000,"react to" \n "explosions" \n "and fire"};
item13[] = {"conversation_fin",4,218,60.000000,-580.000000,150.000000,-530.000000,0.000000,"conversation" \n "finished"};
item14[] = {"move_to_agios_io",2,250,60.000000,-490.000000,150.000000,-440.000000,0.000000,"move to" \n "agios ioannis"};
item15[] = {"half_way_through",4,218,60.000000,-400.000000,150.000000,-350.000000,0.000000,"half way" \n "through"};
item16[] = {"agios_ioannis_st",2,250,60.000000,-310.000000,150.000000,-260.000000,0.000000,"agios ioannis" \n "started"};
item17[] = {"agios_ioannis_se",4,218,60.000000,-220.000000,150.000000,-170.000000,0.000000,"agios ioannis" \n "secure"};
item18[] = {"agios_cephas_sta",2,250,60.000000,780.000000,150.000000,830.000000,0.000000,"agios cephas" \n "started"};
item19[] = {"agios_cephas_houses",4,218,60.000000,1050.000000,150.000000,1100.000000,0.000000,"agios cephas" \n "houses clear"};
item20[] = {"has_backpack",4,218,60.000000,-1660.000000,150.000000,-1610.000000,0.000000,"has backpack"};
item21[] = {"moving_to_meet_the",2,250,60.000000,-1570.000000,150.000000,-1520.000000,0.000000,"moving to meet" \n "the contact"};
item22[] = {"contact_hq",2,250,60.000000,1320.000000,150.000000,1370.000000,0.000000,"contact" \n "hq"};
item23[] = {"near_cephas",4,218,60.000000,870.000000,150.000000,920.000000,0.000000,"near" \n "cephas"};
item24[] = {"clear_houses_sta",2,250,60.000000,960.000000,150.000000,1010.000000,0.000000,"clear houses" \n "started"};
item25[] = {"near_maxwell",4,218,-20.000000,1770.000000,70.000000,1820.000000,0.000000,"near" \n "maxwell"};
item26[] = {"WIN1",1,250,-20.000000,1860.000000,70.000000,1910.000000,0.000000,"WIN1"};
item27[] = {"visual_on_maxwel",4,218,60.000000,1590.000000,150.000000,1640.000000,0.000000,"visual" \n "on maxwell"};
item28[] = {"maxwell_under_fi",2,250,60.000000,1680.000000,150.000000,1730.000000,0.000000,"maxwell under" \n "fire"};
item29[] = {"",7,210,-129.000000,-1909.000122,-121.000008,-1900.999878,0.000000,""};
item30[] = {"group_talks_with",2,250,60.000000,-1210.000000,150.000000,-1160.000000,0.000000,"group talks" \n "with contact"};
item31[] = {"conversation_fin",4,218,60.000000,-1120.000000,150.000000,-1070.000000,0.000000,"conversation" \n "finished"};
item32[] = {"timeout_meet",4,218,-170.000000,1770.000000,-80.000000,1820.000000,1.000000,"timeout" \n "meet"};
item33[] = {"FAIL1",1,250,-170.000000,1860.000000,-80.000000,1910.000000,0.000000,"FAIL1"};
item34[] = {"conversation_fin",4,218,60.000000,-760.000000,150.000000,-710.000000,0.000000,"conversation" \n "finished"};
item35[] = {"report_to_hq",2,250,60.000000,-670.000000,150.000000,-620.000000,0.000000,"report to" \n "hq"};
item36[] = {"help_nikos_frien",2,250,200.000000,-30.000000,290.000000,20.000000,0.000000,"help" \n "nikos friend"};
item37[] = {"medic_near_nikos",4,218,200.000000,60.000000,290.000000,110.000000,1.000000,"medic near" \n "nikos friend"};
item38[] = {"check_nikos_frie",2,250,200.000000,150.000000,290.000000,200.000000,0.000000,"check" \n "nikos friend"};
item39[] = {"delay",4,218,200.000000,240.000000,290.000000,290.000000,0.000000,"delay"};
item40[] = {"report_nikos_friend",2,250,200.000000,330.000000,290.000000,380.000000,0.000000,"report nikos" \n "friend is dead"};
item41[] = {"conversation_fin",4,218,200.000000,420.000000,290.000000,470.000000,0.000000,"conversation" \n "finished"};
item42[] = {"conversation_fin",4,218,60.000000,1410.000000,150.000000,1460.000000,0.000000,"conversation" \n "finished"};
item43[] = {"move_to_maxwell",2,250,60.000000,1500.000000,150.000000,1550.000000,0.000000,"move to maxwell" \n "started"};
item44[] = {"houses_cleared",2,250,60.000000,1140.000000,150.000000,1190.000000,0.000000,"houses" \n "cleared"};
item45[] = {"agios_cephas_sec",4,218,60.000000,1230.000000,150.000000,1280.000000,0.000000,"agios cephas" \n "secure"};
item46[] = {"heavy_casualties",4,218,130.000000,1770.000000,220.000000,1820.000000,1.000000,"heavy" \n "casualties"};
item47[] = {"WIN2",1,250,130.000000,1860.000000,220.000000,1910.000000,0.000000,"WIN2"};
item48[] = {"savegame___regro",2,250,60.000000,-120.000000,150.000000,-70.000000,0.000000,"savegame" \n "& regroup"};
item49[] = {"medic_is_alive",4,218,200.000000,-120.000000,290.000000,-70.000000,1.000000,"medic is" \n "alive"};
item50[] = {"medic_is_dead",4,218,60.000000,-30.000000,150.000000,20.000000,0.000000,"medic is" \n "dead"};
item51[] = {"medic_still_far",4,218,340.000000,-30.000000,430.000000,20.000000,0.000000,"medic still" \n "far from" \n "contact"};
item52[] = {"fake_moving",2,250,340.000000,60.000000,430.000000,110.000000,0.000000,"fake" \n "moving"};
item53[] = {"stop",2,250,60.000000,600.000000,150.000000,650.000000,0.000000,"stop"};
item54[] = {"conversation_fin",4,218,60.000000,690.000000,150.000000,740.000000,0.000000,"conversation" \n "finished"};
link0[] = {0,1};
link1[] = {1,2};
link2[] = {2,3};
link3[] = {2,29};
link4[] = {3,4};
link5[] = {4,20};
link6[] = {5,30};
link7[] = {6,7};
link8[] = {7,53};
link9[] = {8,11};
link10[] = {9,10};
link11[] = {10,5};
link12[] = {11,12};
link13[] = {12,34};
link14[] = {13,14};
link15[] = {14,15};
link16[] = {15,16};
link17[] = {16,17};
link18[] = {17,48};
link19[] = {18,23};
link20[] = {19,44};
link21[] = {20,21};
link22[] = {21,9};
link23[] = {22,42};
link24[] = {23,24};
link25[] = {24,19};
link26[] = {25,26};
link27[] = {27,28};
link28[] = {28,25};
link29[] = {28,46};
link30[] = {29,32};
link31[] = {30,31};
link32[] = {31,8};
link33[] = {32,33};
link34[] = {34,35};
link35[] = {35,13};
link36[] = {36,37};
link37[] = {36,51};
link38[] = {37,38};
link39[] = {38,39};
link40[] = {39,40};
link41[] = {40,41};
link42[] = {41,6};
link43[] = {42,43};
link44[] = {43,27};
link45[] = {44,45};
link46[] = {45,22};
link47[] = {46,47};
link48[] = {48,49};
link49[] = {48,50};
link50[] = {49,36};
link51[] = {50,6};
link52[] = {51,52};
link53[] = {52,37};
link54[] = {53,54};
link55[] = {54,18};
globals[] = {10.000000,1,0,0,0,640,480,1,361,0,1,-327.269806,480.229706,-1109.571411,-2166.823242,818,1071,1};
window[] = {2,-1,-1,-1,-1,1025,175,1615,175,3,836};
*//*%FSM</HEAD>*/
class FSM
{
        fsmName = "A_m04 Mission Flow";
        class States
        {
                /*%FSM<STATE "init">*/
                class init
                {
                        name = "init";
                        itemno = 0;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Meet team timeout" \n
                         "//***************************" \n
                         "private ""_maxMeetTime"";" \n
                         "_maxMeetTime = time + 120;" \n
                         "" \n
                         "//***************************" \n
                         "//Zone restriction trigger" \n
                         "//***************************" \n
                         "[BIS_leadPlayerTrigger] spawn BIS_fnc_a_m04_updateTriggerPosition;" \n
                         "" \n
                         "//***************************" \n
                         "//Instructor Figure" \n
                         "//***************************" \n
                         "[""Init""] call BIS_fnc_InstructorFigure;" \n
                         "" \n
                         "//***************************" \n
                         "//Orbat related" \n
                         "//***************************" \n
                         "BIS_showORBAT = false;" \n
                         "" \n
                         "//***************************" \n
                         "//Friendly Fire" \n
                         "//***************************" \n
                         "private ""_module"";" \n
                         "_module = [""Init"", [units BIS_group + [BIS_contact, BIS_contactFriend], true]] call BIS_fnc_moduleFriendlyFire;" \n
                         "" \n
                         "//***************************" \n
                         "//Casualties" \n
                         "//***************************" \n
                         "BIS_units 					= [BIS_leadPlayer, BIS_medic, BIS_rifleman, BIS_autorifleman, BIS_grenadier];" \n
                         "BIS_unitsMinimum 			= 3;" \n
                         "BIS_unitsCasualtiesSaid	= false;" \n
                         "" \n
                         "{" \n
                         "	_x addEventhandler [""Killed"", {" \n
                         "		if (count BIS_units < BIS_unitsMinimum && !BIS_unitsCasualtiesSaid) then {" \n
                         "			""BIS_x_casualties"" spawn BIS_fnc_missionConversations;" \n
                         "		};" \n
                         "	}];" \n
                         "} forEach BIS_units;" \n
                         "" \n
                         "//****************************************" \n
                         "//Nikos vehicle handledamage" \n
                         "//****************************************" \n
                         "//The destroyed wheels" \n
                         "BIS_vehicleNikosDestroyedWheels = [];" \n
                         "" \n
                         "//The event handler" \n
                         "private ""_handler"";" \n
                         "_handler = BIS_contactCar addEventHandler [""HandleDamage"", {" \n
                         "	private [""_vehicle"", ""_damage"", ""_selection"", ""_source""];" \n
                         "	_vehicle 	= [_this, 0, objNull, [objNull]] call BIS_fnc_param;" \n
                         "	_selection	= [_this, 1, """", [""""]] call BIS_fnc_param;" \n
                         "	_damage	= [_this, 2, 0, [0]] call BIS_fnc_param;" \n
                         "	_source	= [_this, 3, objNull, [objNull]] call BIS_fnc_param;" \n
                         "	" \n
                         "	private ""_selectionLowerCase"";" \n
                         "	_selectionLowerCase = toLower _selection;" \n
                         "	" \n
                         "	private ""_wheels"";" \n
                         "	_wheels = [""wheel_1_1_steering"", ""wheel_1_2_steering"", ""wheel_2_1_steering"", ""wheel_2_2_steering""];" \n
                         "	" \n
                         "	//If damage was done on a wheel and it is high enough, we flag the tire as flat" \n
                         "	if (_selectionLowerCase in _wheels && { _damage >= 0.9 } && { !(_selectionLowerCase in BIS_vehicleNikosDestroyedWheels) }) then {" \n
                         "		BIS_vehicleNikosDestroyedWheels set [count BIS_vehicleNikosDestroyedWheels, _selectionLowerCase];" \n
                         "	};" \n
                         "	" \n
                         "	//Allow damage only if inflicted by the player" \n
                         "	if (_source == player) then {" \n
                         "		_damage;" \n
                         "	} else {" \n
                         "		0;" \n
                         "	};" \n
                         "}];" \n
                         "" \n
                         "//Store event handler on vehicle namespace" \n
                         "BIS_contactCar setVariable [""BIS_handleDamage"", _handler];" \n
                         "" \n
                         "//****************************************" \n
                         "//Nikos vehicle hit" \n
                         "//****************************************" \n
                         "//Friendly fire check" \n
                         "private ""_handler"";" \n
                         "_handler = BIS_contactCar addEventHandler [""Hit"", {" \n
                         "	private [""_vehicle"", ""_attacker"", ""_damage""];" \n
                         "	_vehicle 	= [_this, 0, objNull, [objNull]] call BIS_fnc_param;" \n
                         "	_attacker 	= [_this, 1, objNull, [objNull]] call BIS_fnc_param;" \n
                         "	_damage	= [_this, 2, 0, [0]] call BIS_fnc_param;" \n
                         "	" \n
                         "	//Is the vehicle still usable?" \n
                         "	if (!alive _vehicle || !canMove _vehicle || (!isNil { BIS_vehicleNikosDestroyedWheels } && { count BIS_vehicleNikosDestroyedWheels >= 1 })) then {" \n
                         "		//Remove event handler" \n
                         "		_vehicle removeEventHandler [""Hit"", _vehicle getVariable ""BIS_hit""];" \n
                         "		" \n
                         "		//Player caused the damage?" \n
                         "		if (_attacker == player) then {" \n
                         "			//End mission" \n
                         "			[""FriendlyFire"", false] call BIS_fnc_endMission;" \n
                         "		};" \n
                         "	};" \n
                         "}];" \n
                         "" \n
                         "//Store the event handlers" \n
                         "BIS_contactCar setVariable [""BIS_hit"", _handler];" \n
                         "" \n
                         "" \n
                         "//***************************" \n
                         "//Log" \n
                         "//***************************" \n
                         """FSM initialization done"" call BIS_fnc_log;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "mission_started">*/
                                class mission_started
                                {
                                        itemno = 1;
                                        priority = 0.000000;
                                        to="regroup_started";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"!isNil { BIS_fnc_blackIn_completed }" \n
                                         "&&" \n
                                         "{ BIS_fnc_blackIn_completed }" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "regroup_started">*/
                class regroup_started
                {
                        name = "regroup_started";
                        itemno = 2;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Tasks" \n
                         "//***************************" \n
                         "[""BIS_regroup"", ""ASSIGNED""] call BIS_fnc_missionTasks;" \n
                         "" \n
                         "//***************************" \n
                         "//Conversations" \n
                         "//***************************" \n
                         """BIS_sitrep"" spawn BIS_fnc_missionConversations;" \n
                         "" \n
                         "//***************************" \n
                         "//Ambient jet flyby" \n
                         "//***************************" \n
                         "private [""_start"", ""_direction"", ""_end""];" \n
                         "_start 		= [getMarkerPos ""BIS_lzConnor"", 500, random 360] call BIS_fnc_relPos;" \n
                         "_direction	= [_start, getMarkerPos ""BIS_lzConnor""] call BIS_fnc_dirTo;" \n
                         "_end 		= [getMarkerPos ""BIS_lzConnor"", 2500, _direction] call BIS_fnc_relPos;" \n
                         "" \n
                         "//Flyby" \n
                         "[_start, _end, 200, ""FULL"", ""I_Plane_Fighter_03_CAS_F"", RESISTANCE] call BIS_fnc_ambientFlyby;" \n
                         "" \n
                         "//***************************" \n
                         "//Log" \n
                         "//***************************" \n
                         """Regroup started"" call BIS_fnc_log;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "timeout_meet">*/
                                class timeout_meet
                                {
                                        itemno = 32;
                                        priority = 1.000000;
                                        to="FAIL1";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"time > _maxMeetTime" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                                /*%FSM<LINK "near_group">*/
                                class near_group
                                {
                                        itemno = 3;
                                        priority = 0.000000;
                                        to="backpack_started";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"player distance leader BIS_group < 20" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "backpack_started">*/
                class backpack_started
                {
                        name = "backpack_started";
                        itemno = 4;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Tasks" \n
                         "//***************************" \n
                         "[""BIS_regroup"", ""SUCCEEDED""] call BIS_fnc_missionTasks;" \n
                         """BIS_backpack"" call BIS_fnc_missionTasks;" \n
                         "" \n
                         "//***************************" \n
                         "//Player joins group" \n
                         "//***************************" \n
                         "player joinAsSilent [BIS_group, 6];" \n
                         "" \n
                         "//***************************" \n
                         "//Conversations" \n
                         "//***************************" \n
                         "private ""_conversation"";" \n
                         "_conversation = ""BIS_nearGroup"" spawn BIS_fnc_missionConversations;" \n
                         "" \n
                         "//***************************" \n
                         "//Leader stands up" \n
                         "//***************************" \n
                         "BIS_leadPlayer setUnitPos ""UP"";" \n
                         "" \n
                         "//***************************" \n
                         "//Hints" \n
                         "//***************************" \n
                         "[[""Common"", ""Take""], 15] call BIS_fnc_advHint;" \n
                         "" \n
                         "//***************************" \n
                         "//Music" \n
                         "//***************************" \n
                         "5 fadeMusic 0;" \n
                         "" \n
                         "//***************************" \n
                         "//Log" \n
                         "//***************************" \n
                         """Pickup backpack started"" call BIS_fnc_log;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "has_backpack">*/
                                class has_backpack
                                {
                                        itemno = 20;
                                        priority = 0.000000;
                                        to="moving_to_meet_the";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"backpack player == ""B_Carryall_cbr""" \n
                                         "&&" \n
                                         "scriptDone _conversation" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "lz_connor_starte">*/
                class lz_connor_starte
                {
                        name = "lz_connor_starte";
                        itemno = 6;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Tasks" \n
                         "//***************************" \n
                         "[""BIS_lzConnor"", ""ASSIGNED""] call BIS_fnc_missionTasks;" \n
                         "" \n
                         "//***************************" \n
                         "//Conversations" \n
                         "//***************************" \n
                         "private ""_conversation"";" \n
                         "_conversation = ""BIS_agiosIoannisClear"" spawn BIS_fnc_missionConversations;" \n
                         "" \n
                         "//***************************" \n
                         "//Waypoints" \n
                         "//***************************" \n
                         "[BIS_group, [" \n
                         "	[getMarkerPos ""BIS_waypointGroupThree"", ""MOVE"", 5, [""AWARE"", ""YELLOW"", ""LINE"", ""NORMAL""], nil, true]," \n
                         "	[getMarkerPos ""BIS_waypointGroupFour"", ""MOVE"", 5, [""AWARE"", ""YELLOW"", ""LINE"", ""NORMAL""]]," \n
                         "	[getMarkerPos ""BIS_lzConnor"", ""MOVE"", 5, [""AWARE"", ""YELLOW"", ""LINE"", ""NORMAL""]]" \n
                         "]] call BIS_fnc_a_m04_addWaypoints;" \n
                         "" \n
                         "//***************************" \n
                         "//Team assumes automatic stance" \n
                         "//***************************" \n
                         "{" \n
                         "	_x setUnitPos ""AUTO"";" \n
                         "} forEach units BIS_group;" \n
                         "" \n
                         "//***************************" \n
                         "//Music" \n
                         "//***************************" \n
                         "5 fadeMusic 0.25;" \n
                         "playMusic ""Track12_StageC_action"";" \n
                         "" \n
                         "//***************************" \n
                         "//Log" \n
                         "//***************************" \n
                         """Group is moving to attack LZ Connor"" call BIS_fnc_log;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "lz_connor_secure">*/
                                class lz_connor_secure
                                {
                                        itemno = 7;
                                        priority = 0.000000;
                                        to="stop";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"{ alive _x && side _x == RESISTANCE && _x distance getMarkerPos ""BIS_lzConnor"" < 100 } count allUnits < 1" \n
                                         "&&" \n
                                         "{ _x != player && _x distance getMarkerPos ""BIS_lzConnor"" < 30 } count units BIS_group > 0" \n
                                         "&&" \n
                                         "player distance getMarkerPos ""BIS_lzConnor"" < 30" \n
                                         "&&" \n
                                         "behaviour leader BIS_group != ""COMBAT""" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "lz_connor_is_att">*/
                class lz_connor_is_att
                {
                        name = "lz_connor_is_att";
                        itemno = 8;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Bombardment && Firing" \n
                         "//***************************" \n
                         "[getMarkerPos ""BIS_lzConnor"", nil, nil, nil, { isNil { BIS_stopConnorBombardment } }] spawn BIS_fnc_a_m04_bombardment;" \n
                         "[getMarkerPos ""BIS_lzConnor"", {	player distance getMarkerPos ""BIS_agiosIoannis"" > 250	&&	player distance getMarkerPos ""BIS_lzConnor"" > 400	&&	player distance getMarkerPos ""BIS_agiosCephas"" > 500 }] spawn BIS_fnc_a_m04_firing;" \n
                         "" \n
                         "//***************************" \n
                         "//Light flash" \n
                         "//***************************" \n
                         "//The light source" \n
                         "_light = ""#lightpoint"" createvehiclelocal getMarkerPos ""BIS_lzConnor"";" \n
                         "_light setpos getMarkerPos ""BIS_lzConnor"";" \n
                         "_light setLightBrightness 30;" \n
                         "_light setLightAmbient [0.5, 0.5, 1];" \n
                         "_light setlightcolor [1, 1, 2];" \n
                         "" \n
                         "//Clean up" \n
                         "_light spawn {" \n
                         "	sleep 0.25;" \n
                         "	deletevehicle _this;" \n
                         "};" \n
                         "" \n
                         "//***************************" \n
                         "//Ambient jet flyby" \n
                         "//***************************" \n
                         "private [""_start"", ""_direction"", ""_end""];" \n
                         "_start 		= [getMarkerPos ""BIS_lzConnor"", 2500, random 360] call BIS_fnc_relPos;" \n
                         "_direction	= [_start, getMarkerPos ""BIS_lzConnor""] call BIS_fnc_dirTo;" \n
                         "_end 		= [getMarkerPos ""BIS_lzConnor"", 2500, _direction] call BIS_fnc_relPos;" \n
                         "" \n
                         "//Flyby" \n
                         "[_start, _end, 150, ""FULL"", ""I_Plane_Fighter_03_CAS_F"", RESISTANCE] call BIS_fnc_ambientFlyby;" \n
                         "" \n
                         "//***************************" \n
                         "//Delay" \n
                         "//***************************" \n
                         "private ""_delay"";" \n
                         "_delay = time + 2.5;" \n
                         "" \n
                         "//***************************" \n
                         "//Log" \n
                         "//***************************" \n
                         """LZ Connor is under attack"" call BIS_fnc_log;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "delay">*/
                                class delay
                                {
                                        itemno = 11;
                                        priority = 0.000000;
                                        to="react_to_explosions";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"time > _delay" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "dialog_about_the">*/
                class dialog_about_the
                {
                        name = "dialog_about_the";
                        itemno = 10;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Conversations" \n
                         "//***************************" \n
                         "private ""_conversation"";" \n
                         "_conversation = ""BIS_onTheWayToMeeting"" spawn BIS_fnc_missionConversations;" \n
                         "" \n
                         "//***************************" \n
                         "//Log" \n
                         "//***************************" \n
                         """Chatter about who is the contact group is meeting"" call BIS_fnc_log;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "near_contact_pos">*/
                                class near_contact_pos
                                {
                                        itemno = 5;
                                        priority = 0.000000;
                                        to="group_talks_with";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"player distance BIS_contact < 15" \n
                                         "&&" \n
                                         "leader BIS_group distance BIS_contact < 10" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "react_to_explosions">*/
                class react_to_explosions
                {
                        name = "react_to_explosions";
                        itemno = 12;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Conversations" \n
                         "//***************************" \n
                         "private ""_conversation"";" \n
                         "_conversation = ""BIS_connorUnderAttackGroup"" spawn BIS_fnc_missionConversations;" \n
                         "" \n
                         "//***************************" \n
                         "//Everyone looks at LZ" \n
                         "//***************************" \n
                         "//Contacts" \n
                         "{" \n
                         "	//Enable AI" \n
                         "	_x enableAi ""MOVE"";" \n
                         "	_x enableAi ""ANIM"";" \n
                         "	" \n
                         "	//Position to look at" \n
                         "	private ""_look"";" \n
                         "	_look = getMarkerPos ""BIS_lzConnor"";" \n
                         "	" \n
                         "	//Look at" \n
                         "	_x glanceAt _look;" \n
                         "	_x lookAt _look;" \n
                         "	_x doWatch _look;" \n
                         "	" \n
                         "	//Units in player group will take a knee" \n
                         "	if (group _x == BIS_group) then {" \n
                         "		_x spawn {" \n
                         "			//Random delay" \n
                         "			sleep random 2;" \n
                         "			" \n
                         "			//Take a knee" \n
                         "			_this setUnitPos ""MIDDLE"";" \n
                         "		};" \n
                         "	};" \n
                         "} forEach [BIS_contact, BIS_contactFriend] + units BIS_group;" \n
                         "" \n
                         "//***************************" \n
                         "//Log" \n
                         "//***************************" \n
                         """Reacting to LZ Connor explosions and firing"" call BIS_fnc_log;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "conversation_fin">*/
                                class conversation_fin
                                {
                                        itemno = 34;
                                        priority = 0.000000;
                                        to="report_to_hq";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"scriptDone _conversation" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "move_to_agios_io">*/
                class move_to_agios_io
                {
                        name = "move_to_agios_io";
                        itemno = 14;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Savegame" \n
                         "//***************************" \n
                         "savegame;" \n
                         "" \n
                         "//***************************" \n
                         "//Conversations" \n
                         "//***************************" \n
                         "private ""_conversation"";" \n
                         "_conversation = ""BIS_movingToHelp"" spawn BIS_fnc_missionConversations;" \n
                         "" \n
                         "//***************************" \n
                         "//Reset look at target" \n
                         "//***************************" \n
                         "{" \n
                         "	//Look at" \n
                         "	_x glanceAt objNull;" \n
                         "	_x lookAt objNull;" \n
                         "	_x doWatch objNull;" \n
                         "	" \n
                         "	//Units in player group will take a knee" \n
                         "	if (group _x == BIS_group) then {" \n
                         "		//Take a knee" \n
                         "		_x setUnitPos ""AUTO"";" \n
                         "	};" \n
                         "} forEach units BIS_group;" \n
                         "" \n
                         "//***************************" \n
                         "//Reset fatigue" \n
                         "//***************************" \n
                         "[BIS_group, 0] call BIS_fnc_camp_setFatigue;" \n
                         "" \n
                         "//***************************" \n
                         "//Waypoint" \n
                         "//***************************" \n
                         "[BIS_group, [" \n
                         "	[getMarkerPos ""BIS_agiosIoannis"", ""MOVE"", 0, [""AWARE"", ""YELLOW"", ""LINE"", ""NORMAL""], nil, true]" \n
                         "]] call BIS_fnc_a_m04_addWaypoints;" \n
                         "" \n
                         "//***************************" \n
                         "//Distance to waypoint" \n
                         "//***************************" \n
                         "private [""_distanceTotal"", ""_distanceHalf""];" \n
                         "_distanceTotal = leader BIS_group distance getMarkerPos ""BIS_agiosIoannis"";" \n
                         "_distanceHalf	= _distanceTotal / 2;" \n
                         "" \n
                         "//***************************" \n
                         "//Music" \n
                         "//***************************" \n
                         "5 fadeMusic 0.25;" \n
                         "playMusic ""Track10_StageB_action"";" \n
                         "" \n
                         "//***************************" \n
                         "//Log" \n
                         "//***************************" \n
                         """Moving to Agios Ioannis"" call BIS_fnc_log;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "half_way_through">*/
                                class half_way_through
                                {
                                        itemno = 15;
                                        priority = 0.000000;
                                        to="agios_ioannis_st";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"player distance getMarkerPos ""BIS_agiosIoannis"" < _distanceHalf" \n
                                         "&&" \n
                                         "leader BIS_group distance getMarkerPos ""BIS_agiosIoannis"" < _distanceHalf" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "agios_ioannis_st">*/
                class agios_ioannis_st
                {
                        name = "agios_ioannis_st";
                        itemno = 16;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Tasks" \n
                         "//***************************" \n
                         """BIS_agiosIoannis"" call BIS_fnc_missionTasks;" \n
                         """BIS_lzConnor"" call BIS_fnc_missionTasks;" \n
                         """BIS_agiosCephas"" call BIS_fnc_missionTasks;" \n
                         "" \n
                         "//***************************" \n
                         "//Conversations" \n
                         "//***************************" \n
                         "private ""_conversation"";" \n
                         "_conversation = [] spawn {" \n
                         "	""BIS_howDidTheyFoundOut"" call BIS_fnc_missionConversations;" \n
                         "	""BIS_objectives"" call BIS_fnc_missionConversations;" \n
                         "	""BIS_flanking"" call BIS_fnc_missionConversations;" \n
                         "};" \n
                         "" \n
                         "//***************************" \n
                         "//Group takes a knee" \n
                         "//***************************" \n
                         "{" \n
                         "	_x setUnitPos ""MIDDLE"";" \n
                         "} forEach units BIS_group;" \n
                         "" \n
                         "//***************************" \n
                         "//Reset fatigue" \n
                         "//***************************" \n
                         "[BIS_group, 0] call BIS_fnc_camp_setFatigue;" \n
                         "" \n
                         "//***************************" \n
                         "//Player and medic join other group" \n
                         "//***************************" \n
                         "private ""_groupTemporary"";" \n
                         "_groupTemporary = createGroup WEST;" \n
                         "" \n
                         "//Join group" \n
                         "{" \n
                         "	if (_x != BIS_inf && _x != BIS_leadPlayer && _x != BIS_medic) then {" \n
                         "		[_x] joinSilent _groupTemporary;" \n
                         "	};" \n
                         "} forEach units BIS_group;" \n
                         "" \n
                         "//***************************" \n
                         "//Disable sentences" \n
                         "//***************************" \n
                         "enableSentences false;" \n
                         "" \n
                         "//***************************" \n
                         "//Remove waypoints" \n
                         "//***************************" \n
                         "deleteWaypoint [BIS_group, currentWaypoint BIS_group];" \n
                         "" \n
                         "//***************************" \n
                         "//Player and leader flank left" \n
                         "//***************************" \n
                         "[BIS_group, [" \n
                         "	[getMarkerPos ""BIS_waypointPlayerOne"", ""MOVE"", 5, [""AWARE"", ""YELLOW"", ""ECH LEFT""], nil, true]," \n
                         "	[getMarkerPos ""BIS_waypointPlayerTwo"", ""MOVE"", 5, [""AWARE"", ""YELLOW"", ""ECH LEFT""], [""true"", ""enableSentences true;""]]," \n
                         "	[getMarkerPos ""BIS_agiosIoannis"", ""MOVE"", 5, [""AWARE"", ""YELLOW"", ""ECH LEFT""]]" \n
                         "]] call BIS_fnc_a_m04_addWaypoints;" \n
                         "" \n
                         "//***************************" \n
                         "//Team flanks right" \n
                         "//***************************" \n
                         "[_groupTemporary, [" \n
                         "	[getMarkerPos ""BIS_waypointGroupOne"", ""MOVE"", 5, [""AWARE"", ""YELLOW"", ""ECH RIGHT""], nil, true]," \n
                         "	[getMarkerPos ""BIS_waypointGroupTwo"", ""MOVE"", 5, [""AWARE"", ""YELLOW"", ""ECH RIGHT""], [""true"", ""enableSentences true;""]]," \n
                         "	[getMarkerPos ""BIS_agiosIoannis"", ""MOVE"", 5, [""AWARE"", ""YELLOW"", ""ECH RIGHT""]]" \n
                         "]] call BIS_fnc_a_m04_addWaypoints;" \n
                         "" \n
                         "//***************************" \n
                         "//Spawn enemies at the LZ Connor" \n
                         "//***************************" \n
                         "//Spawn group" \n
                         "private ""_group"";" \n
                         "_group = [getMarkerPos ""BIS_lzConnor"", RESISTANCE, configfile >> ""CfgGroups"" >> ""Indep"" >> ""IND_F"" >> ""Infantry"" >> ""HAF_InfTeam""] call BIS_fnc_spawnGroup;" \n
                         "" \n
                         "//Add waypoint" \n
                         "[_group, [" \n
                         "	[getMarkerPos ""BIS_lzConnor"", ""HOLD"", 15, [""AWARE"", ""GREEN"", ""DIAMOND"", ""FULL""], nil, true]" \n
                         "]] call BIS_fnc_a_m04_addWaypoints;" \n
                         "" \n
                         "//Group properties" \n
                         "_group enableAttack false;" \n
                         "_group allowFleeing 0;" \n
                         "_group enableIRLasers true;" \n
                         "" \n
                         "//Set skill" \n
                         "{" \n
                         "	_x setSkill 0.4;" \n
                         "} forEach units _group;" \n
                         "" \n
                         "//Spawn units in buildings" \n
                         "private [""_center"", ""_radius"", ""_minPositionsAvailable"", ""_maxUnits""];" \n
                         "_center				= getMarkerPos ""BIS_lzConnor"";" \n
                         "_radius					= 70;" \n
                         "_minPositionsAvailable	= 2;" \n
                         "_maxUnits 				= round ([1, _minPositionsAvailable] call BIS_fnc_randomNum);" \n
                         "" \n
                         "//The near buildings" \n
                         "private ""_buildings"";" \n
                         "_buildings = _center nearObjects [""Building"", _radius];" \n
                         "" \n
                         "//The enterable buildings pool" \n
                         "private ""_enterableBuildings"";" \n
                         "_enterableBuildings = [];" \n
                         "" \n
                         "//Make sure we only get enterable buildings" \n
                         "{" \n
                         "	if ([_x, _minPositionsAvailable] call BIS_fnc_isBuildingEnterable) then {" \n
                         "		_enterableBuildings set [count _enterableBuildings, _x];" \n
                         "	};" \n
                         "} forEach _buildings;" \n
                         "" \n
                         "//Spawn group inside buildings" \n
                         "{" \n
                         "	//The group" \n
                         "	private ""_group"";" \n
                         "	_group = [_x, _maxUnits] call BIS_fnc_a_m04_spawnGroupInBuilding;" \n
                         "	" \n
                         "	//Set skill" \n
                         "	{" \n
                         "		_x setSkill 0.4;" \n
                         "	} forEach units _group;" \n
                         "} forEach _enterableBuildings;" \n
                         "" \n
                         "//***************************" \n
                         "//Spawn bodies at the LZ Connor" \n
                         "//***************************" \n
                         "private ""_bodies"";" \n
                         "_bodies = createGroup WEST;" \n
                         "" \n
                         "//FIA soldier near truck" \n
                         "[BIS_truck modelToWorld [-3, 1, 0], random 360, ""B_G_Soldier_F"", _bodies] call BIS_fnc_a_m04_spawnDead;" \n
                         "" \n
                         "//FIA, LZ Connor" \n
                         "for ""_i"" from 0 to 3  do {" \n
                         "	//The position, direction and class of the body" \n
                         "	private [""_position"", ""_direction"", ""_class""];" \n
                         "	_position 	= [getMarkerPos ""BIS_lzConnor"", random 30, random 360] call BIS_fnc_relPos;" \n
                         "	_direction	= random 360;" \n
                         "	_class		= [""B_G_Soldier_F"", ""B_G_Soldier_TL_F"", ""B_G_Soldier_AR_F"", ""B_G_medic_F""] call BIS_fnc_selectRandom;" \n
                         "	" \n
                         "	//Dead body" \n
                         "	[_position, _direction, _class, _bodies] call BIS_fnc_a_m04_spawnDead;" \n
                         "};" \n
                         "" \n
                         "//AAF, LZ Connor" \n
                         "for ""_i"" from 0 to 1  do {" \n
                         "	//The position, direction and class of the body" \n
                         "	private [""_position"", ""_direction"", ""_class""];" \n
                         "	_position 	= [getMarkerPos ""BIS_lzConnor"", random 30, random 360] call BIS_fnc_relPos;" \n
                         "	_direction	= random 360;" \n
                         "	_class		= [""I_soldier_F"", ""I_Soldier_TL_F"", ""I_Soldier_AR_F"", ""I_medic_F""] call BIS_fnc_selectRandom;" \n
                         "	" \n
                         "	//Dead body" \n
                         "	[_position, _direction, _class, _bodies] call BIS_fnc_a_m04_spawnDead;" \n
                         "};" \n
                         "" \n
                         "//***************************" \n
                         "//Ambient jet flyby" \n
                         "//***************************" \n
                         "private [""_start"", ""_direction"", ""_end""];" \n
                         "_start 		= [player, 2500, random 360] call BIS_fnc_relPos;" \n
                         "_direction	= [_start, player] call BIS_fnc_dirTo;" \n
                         "_end 		= [player, 2500, _direction] call BIS_fnc_relPos;" \n
                         "" \n
                         "//Flyby" \n
                         "[_start, _end, 150, ""FULL"", ""I_Plane_Fighter_03_CAS_F"", RESISTANCE] call BIS_fnc_ambientFlyby;" \n
                         "" \n
                         "//***************************" \n
                         "//Show ORBAT icon" \n
                         "//***************************" \n
                         "BIS_showORBAT = true;" \n
                         "" \n
                         "//***************************" \n
                         "//Street lights blinking" \n
                         "//***************************" \n
                         "[getMarkerPos ""BIS_agiosIoannis"", nil, nil, nil, nil, { player distance getMarkerPos ""BIS_lzConnor"" > 50 }] spawn BIS_fnc_a_m04_streetLightsBlinking;" \n
                         "" \n
                         "//***************************" \n
                         "//Instructor Figure" \n
                         "//***************************" \n
                         "[""AddTopic"", [""i_00_Flank"",""A_m04"", localize ""STR_A3_campaign_a_m04_instructor_flank""] ] call BIS_fnc_InstructorFigure;" \n
                         "" \n
                         "//***************************" \n
                         "//Log" \n
                         "//***************************" \n
                         """Attacking Agios Ioannis"" call BIS_fnc_log;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "agios_ioannis_se">*/
                                class agios_ioannis_se
                                {
                                        itemno = 17;
                                        priority = 0.000000;
                                        to="savegame___regro";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"{ alive _x && side _x == RESISTANCE && _x distance getMarkerPos ""BIS_agiosIoannis"" < 100 } count allUnits < 1" \n
                                         "&&" \n
                                         "{ _x != player && _x distance getMarkerPos ""BIS_agiosIoannis"" < 30 } count units BIS_group > 0" \n
                                         "&&" \n
                                         "player distance getMarkerPos ""BIS_agiosIoannis"" < 30" \n
                                         "&&" \n
                                         "behaviour leader BIS_group != ""COMBAT""" \n
                                         "&&" \n
                                         "behaviour leader _groupTemporary != ""COMBAT""" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "agios_cephas_sta">*/
                class agios_cephas_sta
                {
                        name = "agios_cephas_sta";
                        itemno = 18;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Team assumes automatic stance" \n
                         "//***************************" \n
                         "{" \n
                         "	_x setUnitPos ""AUTO"";" \n
                         "} forEach units BIS_group;" \n
                         "" \n
                         "//***************************" \n
                         "//Waypoints" \n
                         "//***************************" \n
                         "[BIS_group, [" \n
                         "	[getMarkerPos ""BIS_waypointGroupFive"", ""MOVE"", 5, [""AWARE"", ""YELLOW"", ""LINE"", ""NORMAL""], nil, true]," \n
                         "	[getMarkerPos ""BIS_waypointGroupSix"", ""MOVE"", 5, [""COMBAT"", ""YELLOW"", ""LINE"", ""NORMAL""], [""true"", ""private '_position'; _position = getMarkerPos 'BIS_agiosCephas'; _position set [2, 5]; [_position] call BIS_fnc_a_m04_flare;""]]," \n
                         "	[getMarkerPos ""BIS_agiosCephas"", ""MOVE"", 5, [""COMBAT"", ""YELLOW"", ""LINE"", ""NORMAL""]]" \n
                         "]] call BIS_fnc_a_m04_addWaypoints;" \n
                         "" \n
                         "//***************************" \n
                         "//Create enemies inside buildings" \n
                         "//At Agios Cephas" \n
                         "//***************************" \n
                         "//The center position and radius" \n
                         "private [""_center"", ""_radius"", ""_minPositionsAvailable"", ""_maxUnits""];" \n
                         "_center				= getMarkerPos ""BIS_agiosCephas"";" \n
                         "_radius					= 40;" \n
                         "_minPositionsAvailable	= 3;" \n
                         "_maxUnits 				= round ([1, _minPositionsAvailable] call BIS_fnc_randomNum);" \n
                         "" \n
                         "//The near buildings" \n
                         "private ""_buildings"";" \n
                         "_buildings = _center nearObjects [""Building"", _radius];" \n
                         "" \n
                         "//The enterable buildings pool" \n
                         "private ""_enterableBuildings"";" \n
                         "_enterableBuildings = [];" \n
                         "" \n
                         "//Make sure we only get enterable buildings" \n
                         "{" \n
                         "	if ([_x, _minPositionsAvailable] call BIS_fnc_isBuildingEnterable) then {" \n
                         "		_enterableBuildings set [count _enterableBuildings, _x];" \n
                         "	};" \n
                         "} forEach _buildings;" \n
                         "" \n
                         "//Loop buildings" \n
                         "{" \n
                         "	//Spawn group inside buildings" \n
                         "	private ""_group"";" \n
                         "	_group = [_x, _maxUnits] call BIS_fnc_a_m04_spawnGroupInBuilding;" \n
                         "	" \n
                         "	//No fleeing allowed" \n
                         "	_group allowFleeing 0;" \n
                         "	" \n
                         "	//Set skill" \n
                         "	{" \n
                         "		_x setSkill 0.4;" \n
                         "	} forEach units _group;" \n
                         "	" \n
                         "	//Get building dimensions" \n
                         "	private [""_boundingBox"", ""_x"", ""_y""];" \n
                         "	_boundingBox 	= boundingBox _x;" \n
                         "	_sizeX			= (_boundingBox select 1) select 0;" \n
                         "	_sizeY			= (_boundingBox select 1) select 1;" \n
                         "	" \n
                         "	//Trigger" \n
                         "	private ""_trigger"";" \n
                         "	_trigger = createTrigger [""EmptyDetector"", position _x];" \n
                         "	_trigger setTriggerArea [_sizeX, _sizeY, getDir _x, true];" \n
                         "	_trigger setTriggerActivation [""GUER"", ""NOT PRESENT"", false];" \n
                         "	_trigger setTriggerTimeout [5, 7, 10, false];" \n
                         "	_trigger setTriggerStatements [""this && [thistrigger, player] call BIS_fnc_inTrigger"", ""if (isNil { BIS_clearedBuildings }) then { BIS_clearedBuildings = 1; } else { BIS_clearedBuildings = BIS_clearedBuildings + 1; };"", """"];" \n
                         "	" \n
                         "	//Platoon leader" \n
                         "	if (_foreachindex == 1) then {" \n
                         "		private ""_leader"";" \n
                         "		_leader = leader _group;" \n
                         "		_leader addheadgear ""H_MilCap_dgtl"";" \n
                         "		_leader addvest ""V_Chestrig_oli"";" \n
                         "		_leader setface ""GreekHead_A3_08"";" \n
                         "	};" \n
                         "} forEach _enterableBuildings;" \n
                         "" \n
                         "//***************************" \n
                         "//Music" \n
                         "//***************************" \n
                         "5 fadeMusic 0.25;" \n
                         "playMusic ""Track10_StageB_action"";" \n
                         "" \n
                         "//***************************" \n
                         "//Log" \n
                         "//***************************" \n
                         """Group is moving to attack Agios Cephasr"" call BIS_fnc_log;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "near_cephas">*/
                                class near_cephas
                                {
                                        itemno = 23;
                                        priority = 0.000000;
                                        to="clear_houses_sta";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"{ _x != player && _x distance getMarkerPos ""BIS_agiosCephas"" < 45 } count units BIS_group > 0" \n
                                         "&&" \n
                                         "player distance getMarkerPos ""BIS_agiosCephas"" < 45" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "moving_to_meet_the">*/
                class moving_to_meet_the
                {
                        name = "moving_to_meet_the";
                        itemno = 21;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Tasks" \n
                         "//***************************" \n
                         "[""BIS_backpack"", ""SUCCEEDED""] call BIS_fnc_missionTasks;" \n
                         "[""BIS_meet"", ""ASSIGNED""] call BIS_fnc_missionTasks;" \n
                         "" \n
                         "//***************************" \n
                         "//Group is allowed to move" \n
                         "//***************************" \n
                         "{" \n
                         "	_x enableAi ""MOVE"";" \n
                         "	_x setUnitPos ""AUTO"";" \n
                         "} forEach units BIS_group;" \n
                         "" \n
                         "//***************************" \n
                         "//Waypoints" \n
                         "//***************************" \n
                         "private [""_relativeDirection"", ""_positionContact"", ""_positionNear""];" \n
                         "_relativeDistance	= 25;" \n
                         "_relativeDirection	= [BIS_contact, BIS_leadPlayer] call BIS_fnc_dirTo;" \n
                         "_positionContact	= position BIS_contact;" \n
                         "_positionNear		= [_positionContact, _relativeDistance, _relativeDirection] call BIS_fnc_relPos;" \n
                         "" \n
                         "[" \n
                         "	BIS_group, [" \n
                         "		[_positionNear, ""MOVE"", 5, [""AWARE"", ""YELLOW"", ""DIAMOND"", ""NORMAL""], nil, true]," \n
                         "		[_positionContact, ""MOVE"", 0, [""SAFE"", ""GREEN"", ""DIAMOND"", ""LIMITED""]]" \n
                         "]] call BIS_fnc_a_m04_addWaypoints;" \n
                         "" \n
                         "//***************************" \n
                         "//Hints" \n
                         "//***************************" \n
                         "[[""Common"", ""Gear""], 15] call BIS_fnc_advHint;" \n
                         "" \n
                         "//***************************" \n
                         "//Music" \n
                         "//***************************" \n
                         "5 fadeMusic 0.25;" \n
                         "playMusic ""Track09_Night_percussions"";" \n
                         "" \n
                         "//***************************" \n
                         "//Log" \n
                         "//***************************" \n
                         """Moving to meet the contact"" call BIS_fnc_log;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "on_the_way_to_ni">*/
                                class on_the_way_to_ni
                                {
                                        itemno = 9;
                                        priority = 1.000000;
                                        to="dialog_about_the";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"player distance getMarkerPos ""BIS_alpha"" >= 75" \n
                                         "&&" \n
                                         "leader BIS_group distance getMarkerPos ""BIS_alpha"" >= 75" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "contact_hq">*/
                class contact_hq
                {
                        name = "contact_hq";
                        itemno = 22;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Tasks" \n
                         "//***************************" \n
                         "[""BIS_agiosCephas"", ""SUCCEEDED""] call BIS_fnc_missionTasks;" \n
                         "" \n
                         "//***************************" \n
                         "//Conversations" \n
                         "//***************************" \n
                         "private ""_conversation"";" \n
                         "_conversation = [] spawn {" \n
                         "	""BIS_agiosCephas"" call BIS_fnc_missionConversations;" \n
                         "	""BIS_agiosCephasResponse"" call BIS_fnc_missionConversations;" \n
                         "};" \n
                         "" \n
                         "//***************************" \n
                         "//Bombardment" \n
                         "//***************************" \n
                         "[getMarkerPos ""BIS_maxwell"", 150, [""M_Mo_120mm_AT"", ""Bo_GBU12_LGB""], [0.5, 1.5]] spawn BIS_fnc_a_m04_bombardment;" \n
                         "" \n
                         "//***************************" \n
                         "//Ambient fire fight effects" \n
                         "//***************************" \n
                         "private ""_trigger"";" \n
                         "_trigger = createTrigger [""EmptyDetector"", position player];" \n
                         "_trigger setTriggerStatements [""true"", """", """"];" \n
                         "_trigger setSoundEffect [""$NONE$"", """", ""BattlefieldExplosions3"", """"];" \n
                         "" \n
                         "//***************************" \n
                         "//Log" \n
                         "//***************************" \n
                         """Contacting HQ about Agios Cephas being clear of enemy presence"" call BIS_fnc_log;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "conversation_fin">*/
                                class conversation_fin
                                {
                                        itemno = 42;
                                        priority = 0.000000;
                                        to="move_to_maxwell";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"scriptDone _conversation" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "clear_houses_sta">*/
                class clear_houses_sta
                {
                        name = "clear_houses_sta";
                        itemno = 24;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Tasks" \n
                         "//***************************" \n
                         """BIS_houses"" call BIS_fnc_missionTasks;" \n
                         "" \n
                         "//***************************" \n
                         "//Conversations" \n
                         "//***************************" \n
                         """BIS_houses"" spawn BIS_fnc_missionConversations;" \n
                         "" \n
                         "//***************************" \n
                         "//Instructor Figure" \n
                         "//***************************" \n
                         "[""AddTopic"", [""i_05_ClearHousesHelp"",""A_m04"", localize ""STR_A3_campaign_a_m04_instructor_houses""] ] call BIS_fnc_InstructorFigure;" \n
                         "" \n
                         "//***************************" \n
                         "//Log" \n
                         "//***************************" \n
                         """Player is ordered to clear the houses at Agios Cephas"" call BIS_fnc_log;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "agios_cephas_houses">*/
                                class agios_cephas_houses
                                {
                                        itemno = 19;
                                        priority = 0.000000;
                                        to="houses_cleared";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"!isNil { BIS_clearedBuildings }" \n
                                         "&&" \n
                                         "{ BIS_clearedBuildings > 3 }" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "WIN1">*/
                class WIN1
                {
                        name = "WIN1";
                        itemno = 26;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Tasks" \n
                         "//***************************" \n
                         "[""BIS_maxwell"", ""SUCCEEDED""] call BIS_fnc_missionTasks;" \n
                         "" \n
                         "//***************************" \n
                         "//End mission" \n
                         "//***************************" \n
                         "[[""A_hub02"", 1], true, true, false] call BIS_fnc_endMission;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "maxwell_under_fi">*/
                class maxwell_under_fi
                {
                        name = "maxwell_under_fi";
                        itemno = 28;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Conversations" \n
                         "//***************************" \n
                         """BIS_visualOnMaxwell"" spawn BIS_fnc_missionConversations;" \n
                         "" \n
                         "//***************************" \n
                         "//Log" \n
                         "//***************************" \n
                         """Group has visual on Camp Maxwell under fire"" call BIS_fnc_log;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "heavy_casualties">*/
                                class heavy_casualties
                                {
                                        itemno = 46;
                                        priority = 1.000000;
                                        to="WIN2";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"player distance getMarkerPos ""BIS_maxwell"" < 1000" \n
                                         "&&" \n
                                         "count units BIS_group < 3" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                                /*%FSM<LINK "near_maxwell">*/
                                class near_maxwell
                                {
                                        itemno = 25;
                                        priority = 0.000000;
                                        to="WIN1";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"player distance getMarkerPos ""BIS_maxwell"" < 1000" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "group_talks_with">*/
                class group_talks_with
                {
                        name = "group_talks_with";
                        itemno = 30;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Tasks" \n
                         "//***************************" \n
                         "[""BIS_meet"", ""SUCCEEDED""] call BIS_fnc_missionTasks;" \n
                         "" \n
                         "//***************************" \n
                         "//Conversations" \n
                         "//***************************" \n
                         "private ""_conversation"";" \n
                         "_conversation = ""BIS_nearContact"" spawn BIS_fnc_missionConversations;" \n
                         "" \n
                         "//***************************" \n
                         "//Look at each other" \n
                         "//***************************" \n
                         "{" \n
                         "	(_x select 0) doWatch (_x select 1);" \n
                         "	(_x select 0) lookAt (_x select 1);" \n
                         "	(_x select 0) glanceAt (_x select 1);" \n
                         "} forEach [" \n
                         "	[BIS_leadPlayer, BIS_contact]," \n
                         "	[BIS_contact, BIS_leadPlayer]" \n
                         "];" \n
                         "" \n
                         "//***************************" \n
                         "//Music" \n
                         "//***************************" \n
                         "5 fadeMusic 0.1;" \n
                         "" \n
                         "//***************************" \n
                         "//Log" \n
                         "//***************************" \n
                         """Group is meeting the contact"" call BIS_fnc_log;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "conversation_fin">*/
                                class conversation_fin
                                {
                                        itemno = 31;
                                        priority = 0.000000;
                                        to="lz_connor_is_att";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"scriptDone _conversation" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "FAIL1">*/
                class FAIL1
                {
                        name = "FAIL1";
                        itemno = 33;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//End mission" \n
                         "//***************************" \n
                         "[[""A_hub02"", 3], false] call BIS_fnc_endMission;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "report_to_hq">*/
                class report_to_hq
                {
                        name = "report_to_hq";
                        itemno = 35;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Tasks" \n
                         "//***************************" \n
                         "[""BIS_supplies"", ""CANCELED""] call BIS_fnc_missionTasks;" \n
                         "" \n
                         "//***************************" \n
                         "//Conversations" \n
                         "//***************************" \n
                         "private ""_conversation"";" \n
                         "_conversation = [] spawn {" \n
                         "	""BIS_nikosBoardingVehicle"" call BIS_fnc_missionConversations;" \n
                         "	""BIS_connorUnderAttackPapabear"" call BIS_fnc_missionConversations;" \n
                         "};" \n
                         "" \n
                         "//***************************" \n
                         "//Contact boards the car and leaves" \n
                         "//***************************" \n
                         "//Unlock the car, keep locked to the player" \n
                         "BIS_contactCar lock 3;" \n
                         "" \n
                         "//Join same group" \n
                         "[BIS_contactFriend] joinSilent BIS_contactGroup;" \n
                         "" \n
                         "//Reset look target" \n
                         "{" \n
                         "	_x glanceAt objNull;" \n
                         "	_x lookAt objNull;" \n
                         "	_x doWatch objNull;" \n
                         "} forEach units BIS_contactGroup;" \n
                         "" \n
                         "//Get in" \n
                         "BIS_contact assignAsCargo BIS_contactCar;" \n
                         "BIS_contactFriend assignAsDriver BIS_contactCar;" \n
                         "units BIS_contactGroup orderGetIn true;" \n
                         "units BIS_contactGroup allowGetIn true;" \n
                         "" \n
                         "//***************************" \n
                         "//Waypoints" \n
                         "//***************************" \n
                         "private [""_nearestRoad"", ""_nearestRoadPosition"", ""_crashPosition""];" \n
                         "_nearestRoad 			= [position BIS_contact, 50] call BIS_fnc_nearestRoad;" \n
                         "_nearestRoadPosition	= position _nearestRoad;" \n
                         "_crashPosition			= getMarkerPos ""BIS_agiosIoannis"";" \n
                         "" \n
                         "[" \n
                         "	BIS_contactGroup, [" \n
                         "		[_nearestRoadPosition, ""MOVE"", 0, [""CARELESS"", ""BLUE"", ""FILE"", ""FULL""], nil, true]," \n
                         "		[_crashPosition, ""MOVE"", 0, [""CARELESS"", ""BLUE"", ""FILE"", ""FULL""], [""true"", ""[this, group this, vehicle this, thislist, getMarkerPos 'BIS_agiosIoannis'] call BIS_fnc_a_m04_nikosScenePrepare;""]]" \n
                         "]] call BIS_fnc_a_m04_addWaypoints;" \n
                         "" \n
                         "//***************************" \n
                         "//Bombardment flag" \n
                         "//***************************" \n
                         "BIS_stopConnorBombardment = true;" \n
                         "" \n
                         "//***************************" \n
                         "//Music" \n
                         "//***************************" \n
                         "5 fadeMusic 0;" \n
                         "" \n
                         "//***************************" \n
                         "//Log" \n
                         "//***************************" \n
                         """Reporting to HQ about LZ Connor under attack"" call BIS_fnc_log;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "conversation_fin">*/
                                class conversation_fin
                                {
                                        itemno = 13;
                                        priority = 0.000000;
                                        to="move_to_agios_io";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"scriptDone _conversation" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "help_nikos_frien">*/
                class help_nikos_frien
                {
                        name = "help_nikos_frien";
                        itemno = 36;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Tasks" \n
                         "//***************************" \n
                         "[""BIS_agiosIoannis"", ""SUCCEEDED""] call BIS_fnc_missionTasks;" \n
                         "" \n
                         "//***************************" \n
                         "//Conversations" \n
                         "//***************************" \n
                         """BIS_medicHelpContact"" spawn BIS_fnc_missionConversations;" \n
                         "" \n
                         "//***************************" \n
                         "//Medic helps Nikos" \n
                         "//***************************" \n
                         "//Disable AI abilities" \n
                         "BIS_medic disableAi ""TARGET"";" \n
                         "BIS_medic disableAi ""AUTOTARGET"";" \n
                         "" \n
                         "//Move to contact position" \n
                         "BIS_medic doMove position BIS_contactFriend;" \n
                         "" \n
                         "//***************************" \n
                         "//Timeout" \n
                         "//***************************" \n
                         "private ""_timeout"";" \n
                         "_timeout = time + 20;" \n
                         "" \n
                         "//***************************" \n
                         "//Log" \n
                         "//***************************" \n
                         """Helping Nikos friend started"" call BIS_fnc_log;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "medic_near_nikos">*/
                                class medic_near_nikos
                                {
                                        itemno = 37;
                                        priority = 1.000000;
                                        to="check_nikos_frie";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"BIS_medic distance BIS_contactFriend <= 1.5" \n
                                         "||" \n
                                         "time > _timeout" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                                /*%FSM<LINK "medic_still_far">*/
                                class medic_still_far
                                {
                                        itemno = 51;
                                        priority = 0.000000;
                                        to="fake_moving";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"unitReady BIS_medic" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "check_nikos_frie">*/
                class check_nikos_frie
                {
                        name = "check_nikos_frie";
                        itemno = 38;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Start patching Nikos" \n
                         "//***************************" \n
                         "//Attach medic to contact" \n
                         "BIS_medic attachTo [BIS_contactFriend, [0.5,-0.25,0]];" \n
                         "" \n
                         "//Set position and direction of the medic" \n
                         "BIS_medic setDir getDir BIS_contactFriend + 90;" \n
                         "" \n
                         "//DisableAi abilities" \n
                         "BIS_medic disableAi ""MOVE"";" \n
                         "BIS_medic disableAi ""ANIM"";" \n
                         "" \n
                         "//Start healing animation" \n
                         "BIS_medic playActionNow ""MedicStart"";" \n
                         "" \n
                         "//***************************" \n
                         "//Delay" \n
                         "//***************************" \n
                         "private ""_delay"";" \n
                         "_delay = time + 10;" \n
                         "" \n
                         "//***************************" \n
                         "//Log" \n
                         "//***************************" \n
                         """Medic is checking nikos friend"" call BIS_fnc_log;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "delay">*/
                                class delay
                                {
                                        itemno = 39;
                                        priority = 0.000000;
                                        to="report_nikos_friend";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"time > _delay" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "report_nikos_friend">*/
                class report_nikos_friend
                {
                        name = "report_nikos_friend";
                        itemno = 40;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Conversations" \n
                         "//***************************" \n
                         "private ""_conversation"";" \n
                         "_conversation = ""BIS_medicSaysContactIsDead"" spawn BIS_fnc_missionConversations;" \n
                         "" \n
                         "//***************************" \n
                         "//Stop patching Nikos" \n
                         "//***************************" \n
                         "//EnableAi abilities" \n
                         "BIS_medic enableAi ""MOVE"";" \n
                         "BIS_medic enableAi ""ANIM"";" \n
                         "BIS_medic enableAi ""TARGET"";" \n
                         "BIS_medic enableAi ""AUTOTARGET"";" \n
                         "" \n
                         "//Detach medic from contact" \n
                         "detach BIS_medic;" \n
                         "" \n
                         "//Medic follows leader" \n
                         "BIS_medic doFollow BIS_leadPlayer;" \n
                         "" \n
                         "//Animation" \n
                         "BIS_medic playMove ""amovpercmstpsraswrfldnon"";" \n
                         "" \n
                         "//***************************" \n
                         "//Log" \n
                         "//***************************" \n
                         """Medic reports Nikos friend is dead"" call BIS_fnc_log;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "conversation_fin">*/
                                class conversation_fin
                                {
                                        itemno = 41;
                                        priority = 0.000000;
                                        to="lz_connor_starte";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"scriptDone _conversation" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "move_to_maxwell">*/
                class move_to_maxwell
                {
                        name = "move_to_maxwell";
                        itemno = 43;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Tasks" \n
                         "//***************************" \n
                         "[""BIS_maxwell"", ""ASSIGNED""] call BIS_fnc_missionTasks;" \n
                         "" \n
                         "//***************************" \n
                         "//Conversations" \n
                         "//***************************" \n
                         """BIS_maxwell"" spawn BIS_fnc_missionConversations;" \n
                         "" \n
                         "//***************************" \n
                         "//Disable fatigue" \n
                         "//***************************" \n
                         "[BIS_group, false] call BIS_fnc_camp_setFatigue;" \n
                         "" \n
                         "//***************************" \n
                         "//Maxwell waypoint" \n
                         "//***************************" \n
                         "[BIS_group, [" \n
                         "	[getMarkerPos ""BIS_maxwell"", ""MOVE"", 0, [""AWARE"", ""YELLOW"", ""LINE"", ""FULL""], nil, true]" \n
                         "]] call BIS_fnc_a_m04_addWaypoints;" \n
                         "" \n
                         "//***************************" \n
                         "//Music" \n
                         "//***************************" \n
                         "5 fadeMusic 0.25;" \n
                         "playMusic ""Track13_StageC_negative"";" \n
                         "addMusicEventHandler [""MusicStop"", ""playMusic 'Track13_StageC_negative';""];" \n
                         "" \n
                         "//***************************" \n
                         "//Log" \n
                         "//***************************" \n
                         """Group is moving to Camp Maxwell"" call BIS_fnc_log;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "visual_on_maxwel">*/
                                class visual_on_maxwel
                                {
                                        itemno = 27;
                                        priority = 0.000000;
                                        to="maxwell_under_fi";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"player distance getMarkerPos ""BIS_maxwell"" < 1200" \n
                                         "&&" \n
                                         "BIS_leadPlayer distance getMarkerPos ""BIS_maxwell"" < 1200" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "houses_cleared">*/
                class houses_cleared
                {
                        name = "houses_cleared";
                        itemno = 44;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Tasks" \n
                         "//***************************" \n
                         "[""BIS_houses"", ""SUCCEEDED""] call BIS_fnc_missionTasks;" \n
                         "" \n
                         "//***************************" \n
                         "//Instructor Figure" \n
                         "//***************************" \n
                         "if ([""TopicExists"",[ ""i_05_ClearHousesHelp"" ] ] call BIS_fnc_InstructorFigure != -1) then {" \n
                         "	[""RemoveTopic"", [""i_05_ClearHousesHelp""] ] call BIS_fnc_InstructorFigure;" \n
                         "};" \n
                         "" \n
                         "//***************************" \n
                         "//Thunders" \n
                         "//***************************" \n
                         "[] spawn {" \n
                         "	while { true } do {" \n
                         "		private [""_position"", ""_height"", ""_distance"", ""_direction""];" \n
                         "		_position 	= position player;" \n
                         "		_height	= 50;" \n
                         "		_distance	= 350;" \n
                         "		_direction	= random 360;" \n
                         "		" \n
                         "		//Set thunder height" \n
                         "		_position set [2, _height];" \n
                         "		" \n
                         "		//Create thunder" \n
                         "		[_position, _distance, _direction] spawn BIS_fnc_camp_thunder;" \n
                         "		" \n
                         "		//Delay" \n
                         "		sleep (45 + random 30);" \n
                         "	};" \n
                         "};" \n
                         "" \n
                         "//***************************" \n
                         "//Delay" \n
                         "//***************************" \n
                         "private ""_delay"";" \n
                         "_delay = time + 10;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "agios_cephas_sec">*/
                                class agios_cephas_sec
                                {
                                        itemno = 45;
                                        priority = 0.000000;
                                        to="contact_hq";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"{ alive _x && side _x == RESISTANCE && _x distance getMarkerPos ""BIS_agiosCephas"" < 100 } count allUnits < 1" \n
                                         "&&" \n
                                         "{ _x != player && _x distance getMarkerPos ""BIS_agiosCephas"" < 30 } count units BIS_group > 0" \n
                                         "&&" \n
                                         "player distance getMarkerPos ""BIS_agiosCephas"" < 30" \n
                                         "&&" \n
                                         "time > _delay" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "WIN2">*/
                class WIN2
                {
                        name = "WIN2";
                        itemno = 47;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Tasks" \n
                         "//***************************" \n
                         "[""BIS_maxwell"", ""SUCCEEDED""] call BIS_fnc_missionTasks;" \n
                         "" \n
                         "//***************************" \n
                         "//End mission" \n
                         "//***************************" \n
                         "[[""A_hub02"", 2], true, true, false] call BIS_fnc_endMission;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "savegame___regro">*/
                class savegame___regro
                {
                        name = "savegame___regro";
                        itemno = 48;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Savegame" \n
                         "//***************************" \n
                         "savegame;" \n
                         "" \n
                         "//***************************" \n
                         "//Regroup" \n
                         "//***************************" \n
                         "//Join units to main group" \n
                         "{" \n
                         "	[_x] joinSilent BIS_group;" \n
                         "} forEach units _groupTemporary;" \n
                         "" \n
                         "//Delete temporary group" \n
                         "deleteGroup _groupTemporary;" \n
                         "" \n
                         "//***************************" \n
                         "//Medic stands up" \n
                         "//***************************" \n
                         "BIS_medic setUnitPos ""UP"";" \n
                         "" \n
                         "//***************************" \n
                         "//Instructor Figure" \n
                         "//***************************" \n
                         "if ([""TopicExists"",[ ""i_00_Flank"" ] ] call BIS_fnc_InstructorFigure != -1) then {" \n
                         "	[""RemoveTopic"", [""i_00_Flank""] ] call BIS_fnc_InstructorFigure;" \n
                         "};" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "medic_is_alive">*/
                                class medic_is_alive
                                {
                                        itemno = 49;
                                        priority = 1.000000;
                                        to="help_nikos_frien";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"alive BIS_medic" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                                /*%FSM<LINK "medic_is_dead">*/
                                class medic_is_dead
                                {
                                        itemno = 50;
                                        priority = 0.000000;
                                        to="lz_connor_starte";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"!alive BIS_medic" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "fake_moving">*/
                class fake_moving
                {
                        name = "fake_moving";
                        itemno = 52;
                        init = /*%FSM<STATEINIT""">*/"//Direction" \n
                         "private ""_directionWanted"";" \n
                         "_directionWanted = [BIS_medic, BIS_contactFriend] call BIS_fnc_dirTo;" \n
                         "" \n
                         "//Distance" \n
                         "private [""_walkDistance"", ""_walkCycleDistance""];" \n
                         "_walkDistance 			= BIS_medic distance BIS_contactFriend;" \n
                         "_walkCycleDistance	= 3.04421;" \n
                         "" \n
                         "//Animation cycles" \n
                         "private [""_numberOfCycles"", ""_numberOfCyclesCeiled""];" \n
                         "_numberOfCycles			= _walkDistance / _walkCycleDistance;" \n
                         "_numberOfCyclesCeiled	= ceil _numberOfCycles;" \n
                         "" \n
                         "//DisableAi abilities" \n
                         "BIS_medic disableAi ""MOVE"";" \n
                         "BIS_medic disableAi ""ANIM"";" \n
                         "" \n
                         "//Set direction, because it still might contain error" \n
                         "BIS_medic setDir _directionWanted;" \n
                         "" \n
                         "//Animate" \n
                         "for ""_i"" from 1 to _numberOfCyclesCeiled do {" \n
                         "	BIS_medic playAction ""WalkF"";" \n
                         "};" \n
                         "" \n
                         "//Log" \n
                         "[""Animating medic movement - Direction wanted: %1 / Walk distance: %2 / Animation Cycles: %3"", _directionWanted, _walkDistance, _numberOfCyclesCeiled] call BIS_fnc_logFormat;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "medic_near_nikos">*/
                                class medic_near_nikos
                                {
                                        itemno = 37;
                                        priority = 1.000000;
                                        to="check_nikos_frie";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"BIS_medic distance BIS_contactFriend <= 1.5" \n
                                         "||" \n
                                         "time > _timeout" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
                /*%FSM<STATE "stop">*/
                class stop
                {
                        name = "stop";
                        itemno = 53;
                        init = /*%FSM<STATEINIT""">*/"//***************************" \n
                         "//Savegame" \n
                         "//***************************" \n
                         "savegame;" \n
                         "" \n
                         "//***************************" \n
                         "//Tasks" \n
                         "//***************************" \n
                         "[""BIS_lzConnor"", ""SUCCEEDED""] call BIS_fnc_missionTasks;" \n
                         "[""BIS_agiosCephas"", ""ASSIGNED""] call BIS_fnc_missionTasks;" \n
                         "[""BIS_maxwell"", ""CANCELED""] call BIS_fnc_missionTasks;" \n
                         "" \n
                         "//***************************" \n
                         "//Conversations" \n
                         "//***************************" \n
                         "private ""_conversation"";" \n
                         "_conversation = [] spawn {" \n
                         "	""BIS_lzConnorCasualties"" call BIS_fnc_missionConversations;" \n
                         "	""BIS_lzConnorPapabear"" call BIS_fnc_missionConversations;" \n
                         "	""BIS_lzConnorGroup"" call BIS_fnc_missionConversations;" \n
                         "};" \n
                         "" \n
                         "//***************************" \n
                         "//Team assumes kneeling stance" \n
                         "//***************************" \n
                         "{" \n
                         "	_x setUnitPos ""MIDDLE"";" \n
                         "} forEach units BIS_group;" \n
                         ""/*%FSM</STATEINIT""">*/;
                        precondition = /*%FSM<STATEPRECONDITION""">*/""/*%FSM</STATEPRECONDITION""">*/;
                        class Links
                        {
                                /*%FSM<LINK "conversation_fin">*/
                                class conversation_fin
                                {
                                        itemno = 54;
                                        priority = 0.000000;
                                        to="agios_cephas_sta";
                                        precondition = /*%FSM<CONDPRECONDITION""">*/""/*%FSM</CONDPRECONDITION""">*/;
                                        condition=/*%FSM<CONDITION""">*/"scriptDone _conversation" \n
                                         ""/*%FSM</CONDITION""">*/;
                                        action=/*%FSM<ACTION""">*/""/*%FSM</ACTION""">*/;
                                };
                                /*%FSM</LINK>*/
                        };
                };
                /*%FSM</STATE>*/
        };
        initState="init";
        finalStates[] =
        {
                "WIN1",
                "FAIL1",
                "WIN2",
        };
};
/*%FSM</COMPILE>*/